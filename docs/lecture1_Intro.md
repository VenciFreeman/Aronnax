---
19/11/06 微电子楼105 刘婷
---

# 目标检测与模型压缩 概述

[TOC]

## **计算机视觉(CV)**

### 基本框架

- 视觉基础
- 底层处理
- 中层处理
- 高层处理

### 视觉形成的三个阶段

1. 特征提取和区域分割
   1. 轮廓
   2. 纹理
   3. 颜色
2. 建模与模式表达(中层处理)
   1. 基于各种物体的抽象化模型
3. 描述和理解
   1. 基于物体的结构知识

### 目标处理基本任务类型

- 图像分类
- 物体包围框 ▲
- 划分(像素层面标定) ▲
- 实例分割(三维)

### 目标检测算法分类

- 传统的目标检测算法
  - Cascade
  - HOG/DPM
  - Haar/SVM
- 候选区域/框+深度学习分类
  - R-CNN
- 基于深度学习的回归方法
  - YOLO

#### 传统的目标检测算法

##### 直方图技术

- 背景明显对比
- 含有双峰的灰度直方图对应像素点
- 使用直方图确定灰度阈值的值
- 泛化能力差(不能很好地拟合以前未见过的新数据 )

##### 卷积神经网络(CNN)

- two-stage：先产生region proposals然后再进行CNN分类/精修(RCNN系列) <更容易准确>
  - 基于候选区域的目标检测
  - SPP-net
    - image -> crop/warp -> conv layers -> fc layers -> output <压缩容易导致形变，精度下降>
    - image -> conv layers ->  spatial pyramid pooling -> fc layers -> output
  - Fast R-CNN
    - 最后一个卷积层后加一个ROI pooling layer
    - 损失函数使用了多任务损失函数
  - Faster R-CNN
    - 最后一个卷积层后，即生成候选框时再加一个RPN结构，直接训练得到候选区域
  - R-CNN: 50s -> Fast R-CNN: 2s -> Faster R-CNN: 0.2s，精度基本不变
- one-stage：直接对输入图像应用算法并输出类别和相应的定位(YOLO/SSD系列) <一般更迅速>
  - 基于直接回归的目标检测算法
  - YOLOv3
  - SSD(YOLO改进)

## **模型压缩案例探讨**

### 研究背景

- CNN对算力和存储要求大
- 移动终端部署，资源有限

#### 目标

- 降低模型参数量、运算量、权值文件大小和运行能耗等
- 提高推理速度，同时兼顾模型精度
- 确定压缩饱和点

#### 适用场景

压缩对象：含有大量卷积层的计算机视觉优化算法

- 去除连接点，压缩特征图 <可能影响精度>
- 权值剪枝(Weight Pruning) <降低了算力可能也无法提高速度>
  - CP
  - Low-rank
- 通道剪枝 <更容易影响精度>
- 权值分解 <提升有限，且1X1矩阵无法分解>
- 权值量化(Quantization) <将浮点型转成定点型，但识别准确率容易降低>
- 紧凑结构设计(例如通过1X1卷积核代替3X3卷积核)
- 混合压缩
  - 自动架构探索

#### 挑战

- 剪枝会显著改变层输入导致模型性能严重下降
- 结构化矩阵、迁移卷积滤波器依赖先验知识
- 边缘计算的硬件限制仍然是阻碍深层CNN扩展的主要问题
- 对于部署平台，模型参数和运算量的减小未必代表速度和能耗等比例降低

### 模型压缩关键技术

#### **深度可分解卷积结构**

- 卷积核数量为N，尺寸为$ D_k $，压缩率为 $ \frac{1}{N}+\frac{1}{D_k^2} $

##### 替换的卷积层选择标准

- 卷积核尺寸不能为1，否则无优化
- 卷积核数量多(前30%，N>>1)
- 参数量，运算量大(前30%)
- 相邻没有yolo层

##### 效果

- mAP(精度)部署推理速度显著提升
- TX2上测试过的FPS也提高将近1/3
- FPS和FLOPS相关度较高，和参数量关系不大

#### **自适步长的动态剪枝策略**

##### 整体剪枝过程

- 筛选卷积层
  - 敏感度指标
    - 权值绝对值和
    - 神经元激活次数
    - 特征图熵值
    - 能量效率
    - LDA分析
    - 层间神经元激活相关性
    - 损失函数泰勒展开
- 确定剪枝步长：根据各层敏感程度
  - YOLOv3中首选FLOPS和参数量较大的16，23层
  - 初始步长N应有足够的调整空间
  - 根据mAP值确定下一步的步长
- 逐层剪枝方法：由确定的步长循环剪枝
  - 根据敏感程度按顺序逐层剪枝

#### **部署场景的模型压缩策略优化**

##### 选择的边缘计算平台

- TX2
- ZCU102

##### 剪枝前后的运行时间对比

- 剪枝方案在不同平台运行时间变化趋势不完全一致
- TX2适合对特征图大的层剪枝
- ZCU102适合对特征图小的层剪枝
